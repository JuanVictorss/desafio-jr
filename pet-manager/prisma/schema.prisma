generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
}

// --- MODELAGEM DAS TABELAS ---

model User {
  id        String    @id @default(uuid()) 
  name      String
  email     String    @unique
  password  String
  mobile    String? 
  document  String?   @unique  
  photoUrl  String?   
  address   String?   
  birthDate DateTime? 

  createdAt DateTime  @default(now())
  updatedAt DateTime  @updatedAt

  pets      Pet[]
  auditLogs AuditLog[]

  @@map("users")
}

model Pet {
  id        String   @id @default(uuid())
  name      String
  age       Int?     // Idade pode ser opcional no cadastro inicial
  type      String   // Cachorro, Gato, etc.
  breed     String?  // Raça (pode ser Vira-lata/Desconhecida)
  description String?  // Observações sobre o pet
  photoUrl    String?  // Foto do pet
  size        String?  // Pequeno, Médio, Grande
  isActive  Boolean  @default(true) // Se o pet for adotado ou falecer, marcamos false

  userId    String
  user      User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  // onDelete: Cascade -> Se apagar o usuário, apaga os pets dele (evita pet orfão no banco)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@map("pets")
}

model AuditLog {
  id        String   @id @default(uuid())
  action    String   // Ex: "LOGIN", "CREATE_PET", "DELETE_PET"
  details   String?  // Ex: "Usuário logou pelo IP x", "Criou o pet Rex"
  
  // Quem fez a ação?
  userId    String
  user      User     @relation(fields: [userId], references: [id], onDelete: Restrict)

  createdAt DateTime @default(now())

  @@map("audit_logs")
}